{% extends "base_show_template.html" %}
  {% block boards %}
  {% endblock %}

{% block contents %}
      <h2 class="sub-header">容器列表
        <a href="[[url_for_add]]" class="btn btn-success btn-sm" aria-label="Left Align" style="margin-left:30px">
                    新增项目<span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                  </a>
        <a href="[[url_for_search]]" class="btn btn-warning btn-sm" aria-label="Left Align" style="margin-left:30px">
                    容器发现<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                  </a>
      </h2>
      <div class="table-responsive">
      <table class="table table-striped">
        <thead>
          <tr>
            <th class="hidden">real id</th>
            <th class="col-sm-1 col-sm-offset-0 ">#</th>
            <th class="col-sm-1 col-sm-offset-0 ">容器名称</th>
            <th class="col-sm-4 col-sm-offset-0 ">容器状态</th>
            <th class="col-sm-1 col-sm-offset-0 ">启动命令</th>
            <th class="col-sm-1 col-sm-offset-0 ">host机器</th>
            <th class="col-sm-1 col-sm-offset-0 ">docker镜像</th>
            <th class="col-sm-5 col-sm-offset-0 ">操作</th>
          </tr>
        </thead>
        <tbody>
          {% for m in members %}
              <tr class="[[m.tr_class]]">
                <td class="hidden">[[m.id]]</td>
                <td >[[loop.index]]</td>
                <td>
                  [[m.container_name]]
                </td>
                <td>
                  [[m.status]]
                  <a type="button" class="btn btn-default btn-xs" aria-label="Left Align" id="err_msg_[[loop.index]]" href="javascript:void(0)">
                    <span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span>
                  </a>
                  <!--<div class="col-sm-1 col-sm-offset-0 "></div>-->
                  <p style="display:none"> [[m.detail]]</p>
                </td>
                <td>
                  [[m.command]]
                </td>
                <td>
                  <a type="" class="" id="url_containers_on_machine" href="[[m.url_containers_on_machine]]">[[m.host_ip]]</a>
                </td>
                <td>
                  <a type="" class="" id="url_containers_on_image" href="[[m.url_containers_on_image]]">[[m.image_name]]</a>
                </td>
                <td>
                  <a type="button" class="btn btn-info btn-xs" aria-label="Left Align" href="[[m.edit_url]]">
                    <span class="glyphicon glyphicon-play" aria-hidden="true"></span>
                  </a>
                  <a type="button" class="btn btn-info btn-xs" aria-label="Left Align" href="[[m.edit_url]]">
                    <span class="glyphicon glyphicon-pause" aria-hidden="true"></span>
                  </a>
                  <a type="button" class="btn btn-info btn-xs" aria-label="Left Align" href="[[m.edit_url]]">
                    <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
                  </a>
                  <a type="button" class="btn btn-info btn-xs" aria-label="Left Align" href="[[m.edit_url]]">
                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                  </a>
                  <button type="button" class="btn btn-danger btn-xs remove-btn" aria-label="Left Align"
                            style="margin-left:10px" value="[[m.id]]">
                    <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                  </button>

                </td>
              </tr>
          {% endfor %}
          </tr>
        </tbody>
      </table>
    </div>
  <script>
            $(document).ready(function() {
                $("a[id^='err_msg_']").click(function (e){
                  $(this).next().find("p").toggle();
                });

                $(".remove-btn").click(function (e) {
                    let res=confirm("remove " + $(this).val());
                    let post_data={
                      "remove":$(this).val(),
                    };
                    if(res){
                      $.post("[[url_for_rm_post]]",
                              post_data,
                              function(ret_data,status){
                        console.log(ret_data);
                        console.log(status);
                        ret_data = JSON.parse(ret_data);
                        $(location).attr("href",ret_data.target_url);
                      });
                    }
                });
            });

  </script>
  {% endblock %}


