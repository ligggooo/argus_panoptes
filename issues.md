# jiliang_monitor

*集成组后台运维管理系统*

1. QueuePool达到最大连接数问题
    可能是链接未及时释放导致
    也可能是postgres或者sql alchemy设置不当导致
        updated 2021/3/10:
            1）session 用完之后及时关闭 用expunge或者freeze来保存信息
            2）使用缓存机制减少对数据库的直接访问
        updated 2021/3/29:
            1) 定时器访问唤醒。完成
        updated 2021/4/5
            1) 配置连接池释放时间，使之小于postgres的连接保持时间
2. 偶尔会出现记录丢失
    丢失之后怎么容错
    如何降低丢失的几率
        updated 2021/3/7:
            1）日志丢失导致树的割裂暂时无解
            2）日志入库顺序打乱引起的树构造错误已经通过增加代码解决
            3）装饰器标错（cross_process标在normal上）导致树节点错挂，暂时无解
3. task的前端呈现需要更清晰
    任务起始时间+树形展开
        updated 2021/3/10:
            1）起始时间统计需要后端merge records时增加一项
            2）树形表示需要使用element UI的树形控件或者e-charts的树图支持
4. 节点记录状态融合和最终呈现信息之间的处理过程混乱
    有必要进行一次重构，将信息加工过程的逻辑梳理清楚
    前端显示需要重新设计，将状态+错误+辅助信息以不同的颜色分栏列出
5. 缺一个pull镜像的功能
        updated 2021/3/31:
            1）前端没有这个按钮
6. 缺批量部署的前端接口，目前在本地手动脚本操作完成
7. 容器管理页面需要依次访问docker服务器，响应非常慢
8. 节点任务起始时间问题
        updated 2021/4/7:
            1）目前初始化为-1
9. 后端返回数据量过大，前端处理缓慢
        updated 2021/4/7:
            1）一次取出一个节点的子节点，在有4000个子任务的情形下，依然很慢
10. 搜索支持： id搜索，时间范围搜索，关键词搜索
11. 记录字段添加环境变量，保证子任务的物理环境可被跟踪
12. 任务树构建在第一次加载时非常缓慢 树查找算法需要优化 todo
13. 多线程服务模式下，任务执行数目统计经常变化--可能有线程竞争现象 todo
14. 大量任务压测时，监控后端响应时间达到10秒量级
